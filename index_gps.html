<!DOCTYPE html>
<html>
<head>
    <title>Vídeo em AR com Verificação de Compatibilidade</title>
    <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>
</head>
<body>
    <a-scene webxr="requiredFeatures: hit-test, local-floor;" renderer="colorManagement: true">
        <a-assets>
            <video id="meu-video" src="vid02.webm" autoplay loop muted crossorigin="anonymous" playsinline></video>
        </a-assets>
        <a-video src="#meu-video" width="1.6" height="0.9" position="0 0 -1"></a-video>
        <a-sky color="#ECECEC"></a-sky>
    </a-scene>

    <div id="ui-container" style="position: absolute; bottom: 20px; width: 100%; text-align: center; z-index: 1;">
        <button id="enter-ar-button" style="display: none; padding: 12px 20px; font-size: 18px;">Iniciar AR</button>
        <p id="error-message" style="display: none; color: white; background-color: rgba(0,0,0,0.5); padding: 10px;">Seu dispositivo não suporta AR via web.</p>
    </div>

    <script>
    document.addEventListener('DOMContentLoaded', async () => {
        const sceneEl = document.querySelector('a-scene');
        const buttonEl = document.getElementById('enter-ar-button');
        const errorMessage = document.getElementById('error-message');
        const videoEl = document.querySelector('#meu-video');

        // VERIFICAÇÃO DE COMPATIBILIDADE
        if (navigator.xr) {
            try {
                const supported = await navigator.xr.isSessionSupported('immersive-ar');
                if (supported) {
                    buttonEl.style.display = 'block'; // Mostra o botão se for compatível
                } else {
                    errorMessage.style.display = 'block'; // Mostra erro se não for
                }
            } catch (e) {
                errorMessage.style.display = 'block';
                console.error("Erro ao verificar suporte a AR:", e);
            }
        } else {
            errorMessage.style.display = 'block'; // Mostra erro se nem o 'navigator.xr' existir
        }

        sceneEl.addEventListener('enter-vr', () => {
            videoEl.play().catch(e => console.error("Erro ao tocar vídeo:", e));
        });

        buttonEl.addEventListener('click', () => {
            sceneEl.enterVR();
        });
    });
    </script>
</body>
</html>
